@page
@model IndexModel
@{
    ViewData["Title"] = "ASP.NET Core and Microsoft Graph";
}

<div>
    <h1>ASP.NET Core and Microsoft Graph</h1>
    <p class="lead">Access Microsoft Graph data using ASP.NET Core.</p>
    @if (User.Identity.IsAuthenticated)
    {
        <h4>
            @if (Model.Photo != null)
            {
                <img src="data:image/jpeg;base64, @Model.Photo" class="user-photo nav-profile-photo rounded-circle align-self-center mr-2" />
            }
            else
            {
                <p>No Pic available for this user. Upload a pic for this user in the Azure portal.</p>
            }
            Welcome @Model.DisplayName!</h4>
    }
    else
    {
        <a class="btn btn-primary btn-large" asp-area="MicrosoftIdentity" asp-controller="Account" asp-action="SignIn">Click here to sign in</a>
    }
</div>